# 文档规划详细指南

## 图形类型详解

### 1. 思维导图 (MindMap)

**适用场景**：
- 概念分类和层级结构
- 知识框架整理
- 头脑风暴结果
- 读书笔记
- 会议要点

**结构特征**：
- 一个中心主题
- 放射状分支
- 层级深度2-4层
- 节点间有隶属关系

**规划要点**：
1. 确定中心主题（最核心的概念）
2. 识别主要分支（一级分类）
3. 细化二级分支（具体要点）
4. 检查逻辑关系是否正确

**示例**：
```
中心：项目管理
├─ 范围管理
│  ├─ 需求收集
│  ├─ 范围定义
│  └─ 变更控制
├─ 时间管理
├─ 成本管理
└─ 质量管理
```

---

### 2. 流程图 (Flowchart)

**适用场景**：
- 操作流程
- 决策逻辑
- 业务流程
- 算法步骤
- 审批流程

**结构特征**：
- 有明确的开始和结束
- 步骤间有先后顺序
- 可能包含条件分支（菱形决策节点）
- 单向或双向流动

**规划要点**：
1. 确定流程起点
2. 按时间顺序列出步骤
3. 标记决策点（是/否分支）
4. 确定流程终点
5. 检查是否有循环或并行路径

**符号规范**：
- 矩形：步骤/操作
- 菱形：决策/判断
- 圆角矩形：开始/结束
- 箭头：流向

---

### 3. 知识图谱 (Knowledge Graph)

**适用场景**：
- 概念间复杂关联
- 实体关系网络
- 多对多关系
- 跨领域知识整合
- 关联性分析

**结构特征**：
- 多个核心节点
- 网状连接（非层级）
- 连接有标签（说明关系类型）
- 无固定中心

**规划要点**：
1. 识别所有关键概念/实体
2. 分析它们之间的关系
3. 给关系命名（如"属于"、"影响"、"依赖"）
4. 布局时避免线条交叉过多
5. 可按主题或类型给节点分组

**关系类型示例**：
- 属于/包含
- 影响/被影响
- 依赖/被依赖
- 相似/对比
- 因果

---

### 4. 时间线 (Timeline)

**适用场景**：
- 历史事件
- 项目里程碑
- 产品迭代
- 个人/公司发展历程
- 规划日程

**结构特征**：
- 时间轴为骨干（水平或垂直）
- 按时间顺序排列事件
- 事件有日期/时间点
- 可包含持续时间

**规划要点**：
1. 确定时间范围（开始-结束）
2. 筛选关键事件（避免过于密集）
3. 标注时间点和事件名称
4. 可添加事件描述（简洁）
5. 可用颜色区分不同阶段

**布局建议**：
- 横向时间线：适合展示较长周期
- 纵向时间线：适合展示详细步骤
- 鱼骨图：适合展示并行发展线

---

### 5. 矩阵图/分类图

**适用场景**：
- 对比分析
- 分类体系
- SWOT分析
- 优先级矩阵
- 特性对比表

**结构特征**：
- 二维或多维矩阵
- 行和列代表不同维度
- 单元格内填充内容
- 可包含权重或评分

**规划要点**：
1. 确定分析维度（如重要vs紧急）
2. 列出所有待分析项
3. 将项放入对应象限/单元格
4. 添加简要说明或优先级

---

## 内容分析方法

### 步骤1：内容类型识别

读取内容后，快速判断类型：

| 关键词/特征 | 内容类型 | 推荐图形 |
|------------|---------|---------|
| "首先...然后...最后..." | 流程描述 | 流程图 |
| "分为...类"、"包括..." | 分类描述 | 思维导图/矩阵图 |
| "19xx年"、"20xx年"、"阶段" | 时序内容 | 时间线 |
| "因为...所以..."、"导致" | 因果关系 | 知识图谱/流程图 |
| "优势/劣势"、"机会/威胁" | 对比分析 | 矩阵图 |
| "概念A与概念B的关系" | 关系描述 | 知识图谱 |

### 步骤2：核心要素提取

无论什么内容，提取以下要素：

1. **主题（Theme）**：用1-2句话概括核心内容
2. **关键词（Keywords）**：提取3-7个核心概念
3. **关系（Relationships）**：
   - 层级关系（包含、属于）
   - 时序关系（先后、持续）
   - 逻辑关系（因果、条件）
   - 关联关系（相似、对比）
4. **结构（Structure）**：内容呈现的组织方式

### 步骤3：复杂度评估

评估内容复杂度，决定节点数量：

- **简单**（5个以内节点）：适合简单流程图或单层思维导图
- **中等**（5-10个节点）：标准思维导图或流程图
- **复杂**（10-15个节点）：分层思维导图或混合图形
- **超复杂**（15+个节点）：建议精简或拆分成多张图

### 步骤4：用户需求推测

考虑用户的潜在需求：

- 如果是学习笔记 → 强调记忆和理解，用思维导图
- 如果是工作汇报 → 强调逻辑和结构，用流程图或时间线
- 如果是创意发散 → 强调关联和拓展，用知识图谱
- 如果是决策分析 → 强调对比和权衡，用矩阵图

---

## 规划草稿模板

### 思维导图规划模板

```
## 📋 可视化规划方案

**内容主题**：[主题]
**推荐图形**：思维导图（MindMap）
**选择理由**：[理由]

**结构规划**：
```
[中心主题]
├─ [分支1名称]
│  ├─ [子节点1]
│  └─ [子节点2]
├─ [分支2名称]
│  ├─ [子节点1]
│  └─ [子节点2]
└─ [分支3名称]
   └─ [子节点]
```

**节点详情**：
- 中心节点：[中心主题描述]
- 分支1：[内容概述]
- 分支2：[内容概述]
- 分支3：[内容概述]

**预期效果**：
[描述预期效果]
```

### 流程图规划模板

```
## 📋 可视化规划方案

**内容主题**：[主题]
**推荐图形**：流程图（Flowchart）
**选择理由**：[理由]

**流程步骤**：
1. 开始：[起点描述]
2. 步骤1：[操作描述]
3. 决策点：[判断条件]
   - 是 → 步骤2
   - 否 → 步骤3
4. 步骤2：[操作描述]
5. 结束：[终点描述]

**预期效果**：
[描述预期效果]
```

### 知识图谱规划模板

```
## 📋 可视化规划方案

**内容主题**：[主题]
**推荐图形**：知识图谱（Knowledge Graph）
**选择理由**：[理由]

**核心节点**：
- 节点A：[概念A]
- 节点B：[概念B]
- 节点C：[概念C]

**关系连接**：
- 节点A → 节点B：[关系类型，如"影响"]
- 节点A → 节点C：[关系类型]
- 节点B → 节点C：[关系类型]

**布局建议**：
[描述如何布局节点以避免混乱]

**预期效果**：
[描述预期效果]
```

### 时间线规划模板

```
## 📋 可视化规划方案

**内容主题**：[主题]
**推荐图形**：时间线（Timeline）
**选择理由**：[理由]

**时间范围**：[起始日期] - [结束日期]

**关键事件**：
- [日期1]：[事件1名称]
  - 详情：[简要描述]
- [日期2]：[事件2名称]
  - 详情：[简要描述]
- [日期3]：[事件3名称]
  - 详情：[简要描述]

**阶段划分**（如有）：
- 阶段1：[名称] ([日期范围])
- 阶段2：[名称] ([日期范围])

**预期效果**：
[描述预期效果]
```

---

## 布局模式选择

根据节点数量和展示需求，选择合适的布局模式：

### 1. 时间线布局（Timeline）

**适用**：
- 时间顺序明确的历程、发展史
- 项目里程碑、历史事件

**变体**：
- **水平时间线**：从左到右，适合节点较少（<10个）
- **垂直时间线**：从上到下，适合节点较多（10-20个）
- **蛇形/之字形**：多行排列，节省空间

**注意事项**：
- 节点多时容易过长，建议改用蛇形布局
- 每个节点宽度需预留足够空间（根据文字长度）

### 2. 放射状布局（Radial / 圆形布局）

**适用**：
- 中心主题明确的内容
- 节点数量中等（8-20个）
- 强调中心与周边的关系

**布局方式**：
- 中心节点在圆心
- 其他节点均匀分布在圆周上
- 从中心向四周放射

**优点**：
- 紧凑美观
- 适合A4纸张展示
- 视觉平衡感强

### 3. 方形/网格布局（Grid）

**适用**：
- 需要分类展示的内容
- 矩阵式对比分析
- 节点较多但关系简单

**布局方式**：
- 按行或列均匀分布
- 每行3-5个节点
- 类似表格的整齐排列

### 4. 螺旋布局（Spiral）

**适用**：
- 时间发展历程
- 有递进关系的内容
- 节点数量较多（15-30个）

**布局方式**：
- 从内向外螺旋展开
- 中心是起点，边缘是终点
- 每圈2-4个节点

**优点**：
- 节省空间
- 同时展示时间线和空间关系
- 适合A4纸张

### 5. 思维导图布局（MindMap）

**适用**：
- 层级结构明确
- 树状分类

**布局方式**：
- 中心主题
- 一级分支放射状
- 二级分支从一级延伸

---

## 布局对齐规范（CRITICAL）

**核心原则：该对齐的必须对齐，保持视觉整洁和专业感**

### 1. 对齐类型

#### A. 水平对齐（X坐标对齐）

**同层级节点水平对齐：**
```
正确：                    错误：
[节点A]  [节点B]         [节点A]  [节点B]
[节点C]  [节点D]            [节点C]
                              [节点D]
   ↑ 同一Y坐标               ↑ 不对齐，混乱
```

**应用场景：**
- 同级分支节点：Y坐标相同
- 流程图步骤：同一行Y坐标相同
- 表格/矩阵布局：行列严格对齐

#### B. 垂直对齐（Y坐标对齐）

**同列节点垂直对齐：**
```
正确：                    错误：
[节点A]                   [节点A]
   ↓                         ↘
[节点B]                      [节点B]
   ↓                            ↓
[节点C]                      [节点C]
   ↑ 同一X坐标               ↑ X坐标不一致
```

**应用场景：**
- 流程图：同一列X坐标相同
- 树状结构：父子节点X坐标对齐
- 分组容器：组内节点左对齐

#### C. 网格对齐（Grid Alignment）

**使用统一的网格系统：**
```
网格大小：50px 或 100px

示例（100px网格）：
X坐标：100, 200, 300, 400...
Y坐标：100, 200, 300, 400...

节点位置：
(100,100)  (300,100)  (500,100)
(100,300)  (300,300)  (500,300)
(100,500)  (300,500)  (500,500)
```

### 2. 布局对齐规则（按图形类型）

#### 时间线布局

**水平时间线：**
```
规则：
- 所有节点 Y坐标相同（如 Y=300）
- X坐标等距递增：X = 起始X + (索引 × 间距)
- 间距建议：150-200px

示例：
节点1: (100, 300)
节点2: (300, 300)   ← 间距200px
节点3: (500, 300)   ← 同一Y坐标
节点4: (700, 300)
```

**垂直时间线：**
```
规则：
- 所有节点 X坐标相同（如 X=300）
- Y坐标等距递增：Y = 起始Y + (索引 × 间距)
- 间距建议：100-150px

示例：
节点1: (300, 100)
节点2: (300, 250)   ← 间距150px
节点3: (300, 400)   ← 同一X坐标
```

**蛇形时间线（之字形）：**
```
规则：
- 奇数行：从左到右，Y坐标相同
- 偶数行：从右到左，Y坐标相同（与奇数行相差行间距）
- 每行节点X坐标等距排列

示例：
第1行（Y=100）：  [A]→[B]→[C]→[D]
第2行（Y=250）：  [H]←[G]←[F]←[E]   ← Y=250（相差150px）
第3行（Y=400）：  [I]→[J]→[K]→[L]   ← Y=400
```

#### 思维导图布局

**放射状对齐：**
```
规则：
- 中心节点：画布中心
- 一级分支：从中心放射，角度均匀分布（360°/分支数）
- 二级分支：从一级分支继续放射，保持角度连续性
- 同一层级的分支到中心的距离相同

计算：
角度 = 360° / n × i  （n=分支数，i=索引）
X = 中心X + cos(角度) × 半径
Y = 中心Y + sin(角度) × 半径

示例（4个分支）：
分支1: 0°   → (中心X+200, 中心Y)
分支2: 90°  → (中心X, 中心Y+200)
分支3: 180° → (中心X-200, 中心Y)
分支4: 270° → (中心X, 中心Y-200)
```

**分层水平对齐：**
```
规则：
- 同一层级节点Y坐标相同
- 层级间距：150-200px
- 同级节点间距：200-300px

示例：
              [中心]
                 ↓
      [分支1]  [分支2]  [分支3]   ← 同一Y坐标
                 ↓
   [子节点1]  [子节点2]  [子节点3]  ← 同一Y坐标（下一层）
```

#### 流程图布局

**标准流程：**
```
规则：
- 步骤横向排列：Y坐标相同，X坐标递增
- 决策菱形：旋转45度或保持方形但位置对齐
- 分支处理：从决策节点垂直分出，保持对齐

示例：
[开始]→[步骤1]→[步骤2]→[决策?]
                   ↓Y偏移
              [分支A]  [分支B]
                   ↓Y相同
              [合并点]→[结束]
```

**泳道图（Swimlane）：**
```
规则：
- 每个泳道Y坐标范围固定
- 泳道内节点左对齐（X坐标相同）
- 跨泳道连接线清晰标注

示例：
泳道1（Y=100-200）：[步骤A]→[步骤B]→[步骤C]
泳道2（Y=250-350）：[步骤D]→[步骤E]→[步骤F]
```

#### 方形/网格布局

**严格网格对齐：**
```
规则：
- 所有节点左上角对齐到网格点
- 节点尺寸统一（宽度、高度一致）
- 行列间距相等

示例（3×3网格，节点150×80px，间距50px）：
(50,50)    (250,50)    (450,50)     ← 间距200px（150+50）
(50,180)   (250,180)   (450,180)    ← 间距130px（80+50）
(50,310)   (250,310)   (450,310)
```

### 3. 对齐检查清单

生成Canvas前必须检查：

**水平对齐：**
- [ ] 同层级的节点Y坐标是否相同？
- [ ] 时间线节点是否在同一水平线上？
- [ ] 表格行内节点是否对齐？

**垂直对齐：**
- [ ] 同列节点X坐标是否相同？
- [ ] 父子节点是否有明确的垂直关系？
- [ ] 分组内节点是否左对齐？

**间距一致：**
- [ ] 同级节点间距是否相等？
- [ ] 层级间距是否一致？
- [ ] 是否遵循网格系统（50px/100px倍数）？

**视觉平衡：**
- [ ] 画布左右是否平衡？
- [ ] 节点分布是否均匀？
- [ ] 是否存在突兀的偏移？

### 4. 快速对齐公式

**水平排列（同Y坐标）：**
```javascript
// n个节点，起始位置(startX, startY)，间距spacing
for (i = 0; i < n; i++) {
    x = startX + i * spacing
    y = startY  // 固定Y坐标
}
```

**垂直排列（同X坐标）：**
```javascript
// n个节点，起始位置(startX, startY)，间距spacing
for (i = 0; i < n; i++) {
    x = startX  // 固定X坐标
    y = startY + i * spacing
}
```

**网格布局：**
```javascript
// rows行，cols列，起始位置(startX, startY)，间距(spacingX, spacingY)
for (row = 0; row < rows; row++) {
    for (col = 0; col < cols; col++) {
        x = startX + col * spacingX
        y = startY + row * spacingY
    }
}
```

**放射状布局：**
```javascript
// n个分支，中心(centerX, centerY)，半径radius
for (i = 0; i < n; i++) {
    angle = (2 * Math.PI / n) * i  // 弧度
    x = centerX + Math.cos(angle) * radius
    y = centerY + Math.sin(angle) * radius
}
```

### 5. 常见对齐错误

| 错误类型 | 示例 | 后果 | 修正 |
|---------|------|------|------|
| **Y坐标不统一** | [A](100,100) [B](200,105) | 看起来歪斜 | [B](200,100) |
| **间距不一致** | [A]--100px--[B]--150px--[C] | 视觉不专业 | 统一为150px |
| **未对齐网格** | (123, 456) | 位置杂乱 | (100, 450) |
| **层级混乱** | 子节点比父节点更靠近中心 | 逻辑不清 | 子节点应更远离中心 |
| **边缘拥挤** | 节点紧贴画布边界 | 不美观 | 留出50-100px边距 |

### 6. 布局对齐最佳实践

1. **先规划后生成**：在纸上或脑中画出布局草图，标记关键坐标
2. **使用网格**：所有坐标取50px或100px的倍数
3. **保持一致**：同类节点尺寸、间距统一
4. **分组处理**：复杂图分区域设计，再整合
5. **预留空间**：为未来扩展留出位置
6. **视觉检查**：生成后在Obsidian中打开，直观检查对齐效果

---

## 布局尺寸规范

### 节点尺寸

| 内容长度 | 推荐尺寸 | 示例 |
|---------|---------|------|
| 短文本（<15字）| 150×60 px | "1976年成立" |
| 中等（15-30字）| 200×80 px | "1984 Macintosh发布" |
| 长文本（30-50字）| 260×100 px | "2011库克接任/乔布斯去世" |
| 超长文本（>50字）| 320×120 px 或拆分 | 建议拆分为多个节点 |

### 画布尺寸

| 用途 | 推荐尺寸 | 说明 |
|------|---------|------|
| A4打印 | 800×1100 px | 标准A4比例 |
| 屏幕展示 | 1200×800 px | 宽屏比例 |
| 正方形 | 800×800 px | 适合放射状/螺旋布局 |
| 长图 | 400×2000+ px | 垂直时间线 |

### 间距规范

- **节点之间**：水平间距 ≥ 50px，垂直间距 ≥ 40px
- **边距**：画布边缘留 50-100px 空白
- **连接线长度**：100-200px 为宜

---

## 文本显示优化

### 避免文字截断

1. **预留足够宽度**：节点宽度 = 文字长度 × 12px + 20px 边距
2. **换行处理**：
   - 使用 `\n` 手动换行
   - 每行不超过10-12个汉字
3. **精简文字**：
   - 日期用短格式：2024.8 而非 2024年8月
   - 删除不必要的助词

### 文本换行示例

```
错误：
"2011年8月24日库克接任CEO乔布斯辞职"

正确：
"2011.8.24\n库克接任CEO\n乔布斯辞职"
或
"2011 库克接任/\n乔布斯去世"
```

---

## 常见问题处理

### 问题1：内容太杂，难以归类

**解决方案**：
- 询问用户最关心的核心是什么
- 建议拆分成多个图
- 使用知识图谱展示复杂关系

### 问题2：关系不清晰

**解决方案**：
- 基于自己的理解进行合理推测
- 在规划草案中注明："此处关系基于推断，请确认"
- 提供两种可能的图形方案让用户选择

### 问题3：用户不满意规划

**应对话术**：
- "您希望调整哪些部分？我可以修改"
- "您觉得哪种图形更适合？我可以重新规划"
- "是否需要增加/删除某些节点？"

### 问题4：内容敏感/私密

**注意**：
- 不要保存用户的敏感内容
- 仅生成可视化文件
- 提醒用户注意数据安全

---

## ob-canvas 生成技巧

### 节点布局原则

1. **中心节点**放在画布中心偏左/上位置
2. **思维导图**：分支均匀分布在中心周围，角度间隔大于45度
3. **流程图**：从左到右或从上到下排列，保持流向清晰
4. **知识图谱**：核心节点居中，其他节点环绕，避免线交叉
5. **时间线**：时间轴居中，事件均匀分布

### 颜色使用建议

- 中心节点：醒目的颜色（如蓝色、橙色）
- 同分支节点：使用相同色系
- 不同类型：用颜色区分（如成功=绿色，警告=黄色，错误=红色）
- 背景：白色或浅色

### 文本规范

- 节点标题：简洁，不超过10个字
- 节点内容：如需详细说明，使用文本节点或卡片节点
- 字体大小：标题 > 内容 > 备注
- 避免过长文本，必要时拆分节点

### 连接规范

- 思维导图：从中心到分支的线
- 流程图：带箭头的线表示流向
- 知识图谱：可带标签说明关系
- 时间线：沿时间轴的线

---

## 质量检查清单

在生成前，检查以下项目：

- [ ] 是否准确理解了内容主题？
- [ ] 选择的图形类型是否合适？
- [ ] 节点数量是否在合理范围（5-15）？
- [ ] 节点关系是否清晰？
- [ ] 是否有遗漏的关键信息？
- [ ] 布局是否合理，不会过于拥挤？
- [ ] 文件名是否符合格式（日期+主题）？
- [ ] 用户是否已确认规划？
